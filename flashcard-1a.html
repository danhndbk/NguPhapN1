<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>N1 Grammar Flashcard (1-25)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * {
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
      touch-action: manipulation;
    }
    body {
      overscroll-behavior: none;
      touch-action: pan-y;
    }
    button, a {
      touch-action: manipulation;
    }
    .flip-card { 
      perspective: 1000px;
      -webkit-perspective: 1000px;
    }
    .flip-card-inner { 
      transition: transform 0.6s;
      transform-style: preserve-3d;
      -webkit-transform-style: preserve-3d;
    }
    .flip-card.flipped .flip-card-inner { 
      transform: rotateY(180deg);
      -webkit-transform: rotateY(180deg);
    }
    .flip-card-front, .flip-card-back { 
      backface-visibility: hidden;
      -webkit-backface-visibility: hidden;
    }
    .flip-card-back { 
      transform: rotateY(180deg);
      -webkit-transform: rotateY(180deg);
    }
    button {
      -webkit-appearance: none;
      appearance: none;
    }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-indigo-900 to-purple-900 p-4">
  <div id="app"></div>

  <script>
    const data = [
      { id: 1, p: "N1 ã‚ã£ã¦ã® N2", m: "N2 cÃ³ Ä‘Æ°á»£c lÃ  nhá» cÃ³ N1", e: "å¥åº·ã‚ã£ã¦ã®ä»•äº‹ã ã‹ã‚‰ã€ä¼‘ã‚€ã®ã‚‚å¤§åˆ‡ã ã‚ˆã€‚", t: "CÃ´ng viá»‡c lÃ  thá»© pháº£i nhá» vÃ o sá»©c khá»e, nÃªn nghá»‰ ngÆ¡i cÅ©ng quan trá»ng." },
      { id: 2, p: "N/æ™®é€šå½¢ + ã¨ã¯ã„ãˆ", m: "Tuy/Máº·c dÃ¹ nÃ³i lÃ ...", e: "ã‚‚ã†é€€é™¢ã—ãŸã¨ã¯ã„ãˆã€ã¾ã ç—…æ°—ãŒå®Œå…¨ã«æ²»ã£ãŸã‚ã‘ã§ã¯ãªã„ã€‚", t: "DÃ¹ nÃ³i lÃ  Ä‘Ã£ xuáº¥t viá»‡n, nhÆ°ng bá»‡nh váº«n chÆ°a khá»i hoÃ n toÃ n." },
      { id: 3, p: "N ã¨ã„ãˆã©ã‚‚", m: "Dáº«u lÃ .../DÃ¹ lÃ ...", e: "ãŸã¨ãˆå­ä¾›ã¨ã„ãˆã©ã‚‚ã€ä¿ºã«å¾“ã‚ãªã„è€…ã«ã¯å®¹èµ¦ã—ãªã„ã€‚", t: "Dáº«u lÃ  tráº» con, tÃ´i cÅ©ng khÃ´ng nhÆ°á»£ng bá»™ ai khÃ´ng tuÃ¢n theo." },
      { id: 4, p: "VãŸ ã¨ã“ã‚ã§", m: "Cho dÃ¹â€¦thÃ¬ cÅ©ngâ€¦", e: "è©¦é¨“å‰æ—¥ã«å‹‰å¼·ã—ãŸã¨ã“ã‚ã§ã€çµæœãŒå¤‰ã‚ã‚‹ã¨ã¯æ€ãˆãªã„ã€‚", t: "DÃ¹ cÃ³ há»c thÃ¬ káº¿t quáº£ cÅ©ng cháº³ng thay Ä‘á»•i." },
      { id: 5, p: "æ™®é€šå½¢ + ã¨ã‚ã£ã¦", m: "VÃ¬...nÃªn (Ä‘Æ°Æ¡ng nhiÃªn)", e: "15å¹´ã¶ã‚Šã®å†ä¼šã¨ã‚ã£ã¦ã€åŒçª“ä¼šã¯å¤§ç››ã‚Šä¸ŠãŒã‚Šã ã£ãŸã€‚", t: "VÃ¬ lÃ  há»™i ngá»™ sau 15 nÄƒm, buá»•i há»p lá»›p vÃ´ cÃ¹ng sÃ´i ná»•i." },
      { id: 6, p: "N/V + æ‰‹å‰", m: "ChÃ­nh vÃ¬...trÆ°á»›c máº·t...", e: "å­ä¾›ãŸã¡ã®æ‰‹å‰ã€ã ã‚‰ã—ãªã„å§¿ã‚’è¦‹ã›ã¦ã¯ä½“è£ãŒæ‚ªã„ã€‚", t: "TrÆ°á»›c máº·t tráº» con, náº¿u cho tháº¥y bá»™ dáº¡ng luá»™m thuá»™m thÃ¬ máº¥t thá»ƒ diá»‡n." },
      { id: 7, p: "1 + åŠ©æ•°è© + ãŸã‚Šã¨ã‚‚", m: "DÃ¹ chá»‰ 1â€¦cÅ©ng khÃ´ngâ€¦", e: "ã‚ã®æ—¥ã®å±ˆè¾±ã¯ã€ä¸€æ—¥ãŸã‚Šã¨ã‚‚å¿˜ã‚ŒãŸã“ã¨ã¯ãªã„ã€‚", t: "Ná»—i há»• tháº¹n Ä‘Ã³, dÃ¹ chá»‰ má»™t ngÃ y tÃ´i cÅ©ng chÆ°a bao giá» quÃªn." },
      { id: 8, p: "Vã‚‹/N + ã ã«", m: "Chá»‰ cáº§n...thÃ´i, lÃ  cÅ©ng...", e: "æ˜æ—¥ã®ãƒ†ã‚¹ãƒˆã‚’è€ƒãˆã‚‹ã ã«æ†‚é¬±ã«ãªã‚‹ã€‚", t: "Chá»‰ cáº§n nghÄ© Ä‘áº¿n bÃ i thi ngÃ y mai lÃ  Ä‘Ã£ tháº¥y chÃ¡n náº£n." },
      { id: 9, p: "N + ã™ã‚‰", m: "Ngay cáº£â€¦/Äáº¿n cáº£â€¦", e: "å½¼ã¯è©±ã™ã“ã¨ã™ã‚‰ã§ããªã„çŠ¶æ…‹ã ã€‚", t: "Anh áº¥y Ä‘ang trong tÃ¬nh tráº¡ng Ä‘áº¿n nÃ³i chuyá»‡n cÅ©ng khÃ´ng thá»ƒ." },
      { id: 10, p: "æ™®é€šå½¢ + ã“ã¨ã¨ã¦", m: "Bá»Ÿi vÃ¬ lÃ­ do lÃ â€¦", e: "æ€¥ãªã“ã¨ã¨ã¦ã€ãŠã‚‚ã¦ãªã—ã‚‚ã§ããšç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ã€‚", t: "Bá»Ÿi gáº¥p gÃ¡p quÃ¡ nÃªn xin lá»—i vÃ¬ khÃ´ng tiáº¿p Ä‘Ã³n chu Ä‘Ã¡o." },
      { id: 11, p: "N/Vã‚‹ + ã¨ã„ã£ãŸã¨ã“ã‚ã ", m: "CÅ©ng chá»‰.../Chá»‰ táº§m...", e: "ã“ã®ã‚¹ãƒ¼ãƒ‘ãƒ¼ã®å“æƒãˆã¯ã€ã‚³ãƒ³ãƒ“ãƒ‹ä»¥ä¸‹ã¨ã„ã£ãŸã¨ã“ã‚ã ã€‚", t: "HÃ ng hÃ³a siÃªu thá»‹ nÃ y chá»‰ táº§m dÆ°á»›i má»©c cá»­a hÃ ng tiá»‡n lá»£i." },
      { id: 12, p: "N + ã§ã¯ã‚ã‚‹ã¾ã„ã—", m: "VÃ¬ cháº³ng pháº£i lÃ ...nÃªn...", e: "å­ã©ã‚‚ã§ã¯ã‚ã‚‹ã¾ã„ã—ã€ã‚ãŒã¾ã¾ã‚’æŠ¼ã—é€šã™ã‚‚ã®ã§ã¯ãªã„ã€‚", t: "Cháº³ng pháº£i tráº» con, nÃªn Ä‘á»«ng khÄƒng khÄƒng Ã½ kiáº¿n mÃ¬nh." },
      { id: 13, p: "V + ãã‚‰ã„ãŒã‚ã‚‹", m: "CÃ³ kiá»ƒu/xu hÆ°á»›ngâ€¦", e: "å½¼ã¯ãªã‚“ã§ã‚‚ä¸€äººã§æ±ºã‚ã¦ã—ã¾ã†ãã‚‰ã„ãŒã‚ã‚‹ã€‚", t: "Anh áº¥y cÃ³ xu hÆ°á»›ng chuyá»‡n gÃ¬ cÅ©ng tá»± mÃ¬nh quyáº¿t Ä‘á»‹nh." },
      { id: 14, p: "Vã‚‹ + å§‹æœ«ã ", m: "Cuá»‘i cÃ¹ng thÃ¬â€¦/Rá»‘t cuá»™câ€¦", e: "å½¼ã¯æ€’ã‚Šå‡ºã—ã¦ã€æš´è¨€ã¾ã§åãå§‹æœ«ã ã€‚", t: "Anh áº¥y ná»•i khÃ¹ng vÃ  cuá»‘i cÃ¹ng thá»‘t ra lá»i khiáº¿m nhÃ£." },
      { id: 15, p: "N + ã”ã¨ã", m: "Táº§m nhÆ°â€¦/Nhá»¯ng thá»© nhÆ°â€¦", e: "éŠã³ã”ã¨ãã«å¿…æ­»ã«ãªã‚‹äº‹ã¯ç„¡ã„ã§ã™ã‚ˆã€‚", t: "Vá»›i viá»‡c nhÆ° Ä‘i chÆ¡i, Ä‘Ã¢u cáº§n dá»‘c háº¿t sá»©c." },
      { id: 16, p: "N + ã¨ããŸã‚‰", m: "(NÃ³i Ä‘áº¿n) N áº¥y Ã , thÃ¬...", e: "ã‚ã„ã¤ã¨ããŸã‚‰ã€å¹³æ°—ã§é…åˆ»ã—ã¦ã€å…¨ç„¶è¬ã‚‰ãªã„ã€‚", t: "NÃ³i Ä‘áº¿n anh ta thÃ¬ cá»© dá»­ng dÆ°ng Ä‘áº¿n muá»™n, khÃ´ng xin lá»—i." },
      { id: 17, p: "N/Aã„ + ã¨ã„ã£ãŸã‚‰ãªã„", m: "VÃ´ cÃ¹ng.../KhÃ´n xiáº¿t", e: "å½¼ã®éƒ¨å±‹ã¯æ±šã„ã¨ã„ã£ãŸã‚‰ãªã„ã€‚", t: "CÄƒn phÃ²ng cá»§a anh áº¥y vÃ´ cÃ¹ng báº©n." },
      { id: 18, p: "Aãª + æ¥µã¾ã‚Šãªã„", m: "VÃ´ cÃ¹ng, cá»±c kÃ¬", e: "è»½è£…ã§å¯Œå£«å±±ã«ç™»ã‚‹ãªã‚“ã¦ã€å±é™ºæ¥µã¾ã‚Šãªã„ã€‚", t: "Leo nÃºi PhÃº SÄ© vá»›i trang phá»¥c nháº¹, vÃ´ cÃ¹ng nguy hiá»ƒm." },
      { id: 19, p: "Vã¦ + ã‚„ã¾ãªã„", m: "Tá»« Ä‘Ã¡y lÃ²ng váº«n luÃ´n...", e: "æ–°äººç¤¾å“¡ã®æˆé•·ã‚’æœŸå¾…ã—ã¦ã‚„ã¾ãªã„ã€‚", t: "VÃ´ cÃ¹ng kÃ¬ vá»ng vÃ o sá»± trÆ°á»Ÿng thÃ nh cá»§a nhÃ¢n viÃªn má»›i." },
      { id: 20, p: "N + ã§ãªãã¦ãªã‚“ã ã‚ã†", m: "Cháº³ng pháº£i N thÃ¬ lÃ  gÃ¬", e: "æ¯æ—¥å­ä¾›ã®ãŸã‚ã«ãŠå¼å½“ã‚’ä½œã‚‹ã“ã¨ãŒã€æ„›ã§ãªããªã‚“ã ã‚ã†ã€‚", t: "NgÃ y nÃ o cÅ©ng lÃ m cÆ¡m há»™p cho con, cháº³ng pháº£i tÃ¬nh yÃªu thÃ¬ lÃ  gÃ¬?" },
      { id: 21, p: "N/V + ãªãã—ã¦ï¼ˆã¯ï¼‰", m: "Náº¿u khÃ´ng cÃ³â€¦thÃ¬â€¦", e: "ä¸¡è¦ªã®æ´åŠ©ãªãã—ã¦ã¯ã€ç”Ÿæ´»ã§ããªã‹ã£ãŸã€‚", t: "Náº¿u khÃ´ng cÃ³ sá»± giÃºp Ä‘á»¡ cá»§a bá»‘ máº¹ thÃ¬ khÃ´ng thá»ƒ sá»‘ng Ä‘Æ°á»£c." },
      { id: 22, p: "Vã¦ + ã‹ã‚‰ã¨ã„ã†ã‚‚ã®", m: "Ká»ƒ tá»« sau khiâ€¦thÃ¬â€¦", e: "å®¶åº­ã‚’æŒã£ã¦ã‹ã‚‰ã¨ã„ã†ã‚‚ã®ã€è‡ªåˆ†ã®æ™‚é–“ãŒé›£ã—ããªã£ãŸã€‚", t: "Ká»ƒ tá»« khi cÃ³ gia Ä‘Ã¬nh, khÃ³ dÃ nh thá»i gian cho báº£n thÃ¢n." },
      { id: 23, p: "N + ã„ã‹ã‚“ã§ï¼ˆã¯ï¼‰", m: "TÃ¹y vÃ o N mÃ â€¦", e: "ãƒ†ã‚¹ãƒˆã®çµæœã„ã‹ã‚“ã§ã¯ã€å¤§å­¦ã‚’è¾ã‚ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚", t: "TÃ¹y vÃ o káº¿t quáº£ thi mÃ  cÃ³ thá»ƒ pháº£i nghá»‰ há»c." },
      { id: 24, p: "Vã¦ + ã¯ã°ã‹ã‚‰ãªã„", m: "Cháº³ng ngáº¡i gÃ¬ mÃ ...", e: "å½¼ã¯è‡ªåˆ†ãŒä¸€ç•ªå„ªç§€ã ã¨è¨€ã£ã¦ã¯ã°ã‹ã‚‰ãªã„ã€‚", t: "Anh áº¥y cháº³ng ngáº¡i tuyÃªn bá»‘ mÃ¬nh lÃ  giá»i nháº¥t." },
      { id: 25, p: "Vã¦ + ã¯ã‹ãªã‚ãªã„", m: "Tháº­t khÃ³ chá»‹u khi...", e: "çµ¦æ–™ã‚’å‹æ‰‹ã«æ¸›ã‚‰ã•ã‚Œã¦ã¯ã‹ãªã‚ãªã„ã€‚", t: "Tháº­t khÃ³ chá»‹u khi cÃ´ng ty tá»± Ã½ giáº£m lÆ°Æ¡ng." },
    ];

    let mastered = [];
    let idx = 0;
    let tab = 'all';
    let flipped = false;
    let isShuffled = false;
    let shuffledData = [];

    // Load dá»¯ liá»‡u tá»« localStorage
    function loadData() {
      try {
        mastered = JSON.parse(localStorage.getItem('n1_mastered_1a') || '[]');
      } catch (e) {
        mastered = [];
      }
    }

    function saveData() {
      try {
        localStorage.setItem('n1_mastered_1a', JSON.stringify(mastered));
      } catch (e) {
        console.error('KhÃ´ng thá»ƒ lÆ°u dá»¯ liá»‡u');
      }
    }

    // HÃ m xÃ¡o trá»™n máº£ng
    function shuffleArray(array) {
      const newArray = [...array];
      for (let i = newArray.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
      }
      return newArray;
    }

    function toggleShuffle() {
      isShuffled = !isShuffled;
      if (isShuffled) {
        // Táº¡o má»™t danh sÃ¡ch ngáº«u nhiÃªn má»›i
        shuffledData = shuffleArray(data);
      }
      // Reset vá» tháº» Ä‘áº§u tiÃªn (cá»§a danh sÃ¡ch má»›i hoáº·c danh sÃ¡ch gá»‘c)
      idx = 0;
      flipped = false;
      render();
    }

    function getCards() {
      const sourceData = isShuffled ? shuffledData : data;
      if (tab === 'all') return sourceData;
      if (tab === 'learning') return sourceData.filter(c => !mastered.includes(c.id));
      return sourceData.filter(c => mastered.includes(c.id));
    }

    function render() {
      const cards = getCards();
      const card = cards[idx] || null;
      const app = document.getElementById('app');
      
      if (!card) {
        app.innerHTML = `
          <div class="max-w-md mx-auto">
            <div class="flex items-center justify-between mb-4">
              <a href="index.html" class="text-white hover:text-yellow-300 transition text-lg">â† Menu</a>
              <h1 class="text-white text-xl font-bold">N1 (1-25)</h1>
              <div class="w-16"></div>
            </div>
            <div class="text-white text-center mt-20 text-lg">KhÃ´ng cÃ³ tháº» nÃ o trong má»¥c nÃ y</div>
            <div class="flex justify-center mt-6">
                 <button id="btn-all-empty" class="px-4 py-2 rounded-lg text-sm font-medium bg-white/20 text-white hover:bg-white/30 transition">
                   Xem táº¥t cáº£ tháº»
                 </button>
            </div>
          </div>
        `;
        document.getElementById('btn-all-empty')?.addEventListener('click', () => setTab('all'));
        return;
      }
      
      app.innerHTML = `
        <div class="max-w-md mx-auto pb-4">
          <div class="flex items-center justify-between mb-4">
            <a href="index.html" class="text-white hover:text-yellow-300 transition text-lg">â† Menu</a>
            <h1 class="text-white text-xl font-bold">N1 (1-25)</h1>
            <div class="w-16"></div>
          </div>
          
          <div class="flex justify-center gap-2 mb-4 flex-wrap">
            <button id="btn-all" class="px-4 py-2 rounded-lg text-sm font-medium transition ${tab === 'all' ? 'bg-yellow-400 text-gray-900' : 'bg-white/20 text-white'}">
              Táº¥t cáº£ (${data.length})
            </button>
            <button id="btn-learning" class="px-4 py-2 rounded-lg text-sm font-medium transition ${tab === 'learning' ? 'bg-yellow-400 text-gray-900' : 'bg-white/20 text-white'}">
              ChÆ°a thuá»™c (${data.length - mastered.length})
            </button>
            <button id="btn-mastered" class="px-4 py-2 rounded-lg text-sm font-medium transition ${tab === 'mastered' ? 'bg-yellow-400 text-gray-900' : 'bg-white/20 text-white'}">
              ÄÃ£ thuá»™c (${mastered.length})
            </button>
            <button id="btn-shuffle" class="px-4 py-2 rounded-lg text-sm font-medium transition ${isShuffled ? 'bg-green-400 text-gray-900' : 'bg-white/20 text-white'}">
              ${isShuffled ? 'ğŸ”€ Äang xÃ¡o' : 'ğŸ”€ XÃ¡o trá»™n'}
            </button>
          </div>

          <div class="text-white text-center mb-3 text-lg">
             ${idx + 1} / ${cards.length} 
             ${isShuffled ? '<span class="text-xs ml-1 opacity-75">(Ngáº«u nhiÃªn)</span>' : ''}
          </div>
          
          <div id="flashcard" class="flip-card h-80 cursor-pointer ${flipped ? 'flipped' : ''}">
            <div class="flip-card-inner relative w-full h-full">
              <div class="flip-card-front absolute inset-0 bg-white rounded-2xl shadow-2xl flex flex-col items-center justify-center p-6">
                <div class="text-sm text-gray-400 mb-2">#${card.id}</div>
                <div class="text-2xl font-bold text-indigo-700 text-center leading-relaxed px-2">${card.p}</div>
                <div class="text-gray-400 mt-6 text-sm">ğŸ‘† Nháº¥n Ä‘á»ƒ láº­t tháº»</div>
              </div>
              <div class="flip-card-back absolute inset-0 bg-gradient-to-br from-yellow-100 to-orange-100 rounded-2xl shadow-2xl p-4 overflow-auto">
                <div class="text-indigo-700 font-bold mb-2">ğŸ“– NghÄ©a:</div>
                <div class="text-gray-800 mb-3 text-base">${card.m}</div>
                <div class="text-indigo-700 font-bold mb-2">ğŸ“ VÃ­ dá»¥:</div>
                <div class="text-gray-800 mb-2 text-sm">${card.e}</div>
                <div class="text-green-700 italic text-sm">â†’ ${card.t}</div>
              </div>
            </div>
          </div>

          <div class="flex justify-center items-center gap-3 mt-6">
            <button id="btn-prev" class="w-14 h-14 bg-white/20 hover:bg-white/40 active:bg-white/50 rounded-full text-white text-2xl font-bold transition flex items-center justify-center">â†</button>
            <button id="btn-master" class="px-5 py-3 rounded-lg font-medium transition ${mastered.includes(card.id) ? 'bg-green-500 text-white active:bg-green-600' : 'bg-white text-gray-700 active:bg-gray-200'}">
              ${mastered.includes(card.id) ? 'âœ“ ÄÃ£ thuá»™c' : 'â˜ ÄÃ¡nh dáº¥u thuá»™c'}
            </button>
            <button id="btn-next" class="w-14 h-14 bg-white/20 hover:bg-white/40 active:bg-white/50 rounded-full text-white text-2xl font-bold transition flex items-center justify-center">â†’</button>
          </div>
        </div>
      `;

      // Gáº¯n sá»± kiá»‡n (Event Listeners)
      document.getElementById('flashcard').addEventListener('click', flipCard);
      document.getElementById('btn-all').addEventListener('click', () => setTab('all'));
      document.getElementById('btn-learning').addEventListener('click', () => setTab('learning'));
      document.getElementById('btn-mastered').addEventListener('click', () => setTab('mastered'));
      
      // Sá»¬A: ÄÃ£ thÃªm sá»± kiá»‡n cho nÃºt Shuffle
      document.getElementById('btn-shuffle').addEventListener('click', toggleShuffle);
      
      document.getElementById('btn-prev').addEventListener('click', prev);
      document.getElementById('btn-next').addEventListener('click', next);
      document.getElementById('btn-master').addEventListener('click', () => toggleMaster(card.id));
    }

    function setTab(t) { 
      tab = t; 
      idx = 0; 
      flipped = false; 
      render(); 
    }

    function flipCard(e) { 
      e.stopPropagation();
      flipped = !flipped; 
      render(); 
    }

    function next() { 
      const cards = getCards(); 
      flipped = false; 
      // Náº¿u Ä‘ang shuffle, cards Ä‘Ã£ Ä‘Æ°á»£c xÃ¡o trá»™n sáºµn, nÃªn chá»‰ cáº§n tÄƒng index
      idx = (idx + 1) % cards.length; 
      render(); 
    }

    function prev() { 
      const cards = getCards(); 
      flipped = false; 
      idx = (idx - 1 + cards.length) % cards.length; 
      render(); 
    }

    function toggleMaster(id) {
      if (mastered.includes(id)) {
        mastered = mastered.filter(x => x !== id);
      } else {
        mastered.push(id);
      }
      saveData();
      render();
    }

    // Khá»Ÿi Ä‘á»™ng app
    loadData();
    render();
  </script>
</body>
</html>